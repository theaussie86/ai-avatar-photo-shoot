---
phase: 08-ai-suggestions-quality-feedback
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/avatar-creator/VideoPromptPanel.tsx
  - components/avatar-creator/ActionSuggestions.tsx
  - components/avatar-creator/PromptLengthFeedback.tsx
autonomous: true

must_haves:
  truths:
    - "User sees fixed action suggestion chips (lächeln, winken, nicken, drehen)"
    - "User can click suggestion chip to add action to instruction textarea"
    - "Multiple clicked suggestions appear comma-separated in textarea"
    - "Clicked suggestions show highlighted/active state"
    - "User sees word count below generated prompt with color feedback"
    - "50-150 words shows green, 151-200 yellow, >200 red"
  artifacts:
    - path: "components/avatar-creator/ActionSuggestions.tsx"
      provides: "Fixed action suggestion chips with toggle state"
      exports: ["ActionSuggestions"]
    - path: "components/avatar-creator/PromptLengthFeedback.tsx"
      provides: "Word count display with color coding"
      exports: ["PromptLengthFeedback"]
    - path: "components/avatar-creator/VideoPromptPanel.tsx"
      provides: "Instruction textarea and integration of suggestions + feedback"
  key_links:
    - from: "VideoPromptPanel.tsx"
      to: "ActionSuggestions.tsx"
      via: "selectedSuggestions state passed down, onToggle callback"
      pattern: "selectedSuggestions.*onToggle"
    - from: "VideoPromptPanel.tsx"
      to: "handleGenerate"
      via: "userInstruction derived from selectedSuggestions"
      pattern: "userInstruction.*selectedSuggestions"
---

<objective>
Add fixed action suggestions and instruction input to VideoPromptPanel, plus word count feedback for generated prompts.

Purpose: Help users create better video prompts by providing quick action suggestions (lächeln, winken, nicken, drehen) and showing prompt length guidance (50-150 words optimal for video AI tools).

Output: ActionSuggestions component with chip-based toggle UI, PromptLengthFeedback component with colored word count, VideoPromptPanel updated with instruction textarea and integrated components.
</objective>

<execution_context>
@/Users/cweissteiner/.claude/get-shit-done/workflows/execute-plan.md
@/Users/cweissteiner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-ai-suggestions-quality-feedback/08-CONTEXT.md

@components/avatar-creator/VideoPromptPanel.tsx
@components/avatar-creator/VideoPromptConfig.tsx
@lib/video-prompt-schemas.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ActionSuggestions component with fixed suggestion chips</name>
  <files>components/avatar-creator/ActionSuggestions.tsx</files>
  <action>
Create ActionSuggestions component that displays fixed action suggestion chips.

Props:
- selectedSuggestions: string[] - currently selected suggestions
- onToggle: (suggestion: string) => void - toggle callback
- disabled?: boolean

Fixed suggestions (German):
- "lächeln" (smile)
- "winken" (wave)
- "nicken" (nod)
- "drehen" (turn)

UI:
- Use same chip style pattern as VideoPromptConfig (rounded-full, purple highlight when selected)
- Section header: "Aktions-Vorschläge" (text-xs text-gray-500)
- Flex wrap layout for chips
- Toggle behavior: clicking selected chip deselects it
- Selected state: bg-purple-500/20 border-purple-500 text-purple-400
- Unselected state: bg-transparent border-white/10 text-gray-400

Leave space for AI suggestions (will be added in Plan 2 with sparkle icon).
  </action>
  <verify>
    - File exists at components/avatar-creator/ActionSuggestions.tsx
    - Component exports ActionSuggestions
    - Contains 4 fixed suggestions: lächeln, winken, nicken, drehen
    - Uses chip styling consistent with VideoPromptConfig
  </verify>
  <done>
ActionSuggestions component renders 4 fixed German suggestion chips with toggle behavior and consistent styling
  </done>
</task>

<task type="auto">
  <name>Task 2: Create PromptLengthFeedback component</name>
  <files>components/avatar-creator/PromptLengthFeedback.tsx</files>
  <action>
Create PromptLengthFeedback component that displays word count with color-coded feedback.

Props:
- text: string - the prompt text to analyze

Implementation:
- Count words using text.trim().split(/\s+/).filter(Boolean).length
- Display format: "{count} Wörter" (German)

Color thresholds (from CONTEXT.md and Phase 2 decisions):
- 50-150 words: text-green-500 (optimal)
- 151-200 words: text-yellow-500 (warning)
- >200 words: text-red-500 (too long)
- <50 words: text-gray-500 (no warning, neutral)

UI: Simple text, no progress bar or icons. Small text (text-xs or text-sm).
  </action>
  <verify>
    - File exists at components/avatar-creator/PromptLengthFeedback.tsx
    - Component exports PromptLengthFeedback
    - Word count calculation works correctly
    - Color changes based on thresholds: green (50-150), yellow (151-200), red (>200)
  </verify>
  <done>
PromptLengthFeedback component displays word count with appropriate color based on optimal length thresholds
  </done>
</task>

<task type="auto">
  <name>Task 3: Integrate suggestions, instruction input, and feedback into VideoPromptPanel</name>
  <files>components/avatar-creator/VideoPromptPanel.tsx</files>
  <action>
Update VideoPromptPanel to include:

1. Add state for selected suggestions:
   - const [selectedSuggestions, setSelectedSuggestions] = useState<string[]>([])

2. Add suggestion toggle handler:
   - Toggle adds/removes from array
   - Clear suggestions when new prompt generated successfully

3. Add instruction textarea state:
   - const [customInstruction, setCustomInstruction] = useState("")

4. Derive userInstruction for generation:
   - Combine selectedSuggestions (comma-separated) with customInstruction
   - Format: "lächeln, winken" or "lächeln, winken. Langsam bewegen" if custom text added

5. UI placement (in empty state, before VideoPromptConfig):
   - ActionSuggestions component (top)
   - Small instruction textarea with label "Eigene Anweisungen (optional)"
   - Placeholder: "z.B. langsam nach rechts schauen..."
   - Then VideoPromptConfig (camera style, film effects)
   - Then generate button

6. In content state (after prompt text display):
   - Add PromptLengthFeedback component below the prompt text bg-white/5 div
   - Before the action buttons row

7. Update handleGenerate:
   - Pass userInstruction to generateMutation.mutate()
   - Clear selectedSuggestions and customInstruction on success

8. Import new components at top of file.
  </action>
  <verify>
    - npm run build passes
    - npm run lint passes (only pre-existing warnings)
    - ActionSuggestions imported and rendered in empty state
    - Instruction textarea appears below suggestions
    - PromptLengthFeedback appears below prompt text in content state
    - userInstruction passed to generateMutation
  </verify>
  <done>
VideoPromptPanel integrates action suggestions, instruction input, and prompt length feedback with proper state management
  </done>
</task>

</tasks>

<verification>
1. Build passes: `npm run build`
2. Lint passes: `npm run lint` (only pre-existing warnings acceptable)
3. Visual check: Open panel on an image:
   - Empty state shows suggestions → textarea → config → button
   - Generate with suggestion selected → check prompt includes action
   - Content state shows prompt text → word count → action buttons
</verification>

<success_criteria>
- Fixed suggestion chips render and toggle correctly
- Instruction textarea accepts user input
- Generated prompt includes selected suggestions in userInstruction
- Word count displays below prompt with correct color coding
- UI maintains consistency with existing panel design
</success_criteria>

<output>
After completion, create `.planning/phases/08-ai-suggestions-quality-feedback/08-01-SUMMARY.md`
</output>
